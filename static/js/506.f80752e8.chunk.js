"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[506],{2506:function(e,n,t){t.r(n),t.d(n,{default:function(){return oe}});var r=t(2791),s=t(1241),i=t(4729),a=t(4165),o=t(5861),c=t(9439),l=t(4554),d=t(8496),x=t(3466),p=t(890),m=t(6151),u=t(8820),h=t(7689),f=t(2366),g=t(3708),j=t(6893),Z=t(3538),b=t(184),v=function(){var e=(0,r.useState)(""),n=(0,c.Z)(e,2),t=n[0],s=n[1],i=(0,r.useState)([]),v=(0,c.Z)(i,2),y=v[0],w=v[1],k=(0,r.useState)([]),S=(0,c.Z)(k,2),C=S[0],R=S[1],I=(0,r.useState)(""),_=(0,c.Z)(I,2),D=_[0],N=_[1],T=(0,r.useState)(!1),A=(0,c.Z)(T,2),E=A[0],F=A[1],L=function(){F((function(e){return!e}))},U=(0,h.s0)();(0,r.useEffect)((function(){var e=setTimeout((function(){N(t)}),300);return function(){clearTimeout(e)}}),[t]),(0,r.useEffect)((function(){var e=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var n,t,r,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D){e.next=4;break}return w([]),R([]),e.abrupt("return");case 4:return e.prev=4,e.next=7,f.Z.get("/search/".concat(D));case 7:n=e.sent,t=n.data,r=t.users,s=t.posts,w(s),R(r),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),console.error(e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(){return e.apply(this,arguments)}}();e()}),[D]);return(0,b.jsxs)(l.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",margin:"1rem"},children:[(0,b.jsx)(d.Z,{id:"search",variant:"outlined",name:"search",label:"Search ..",onKeyPress:function(e){"Enter"===e.key&&e.preventDefault()},value:t,onChange:function(e){return s(e.target.value)},InputProps:{startAdornment:(0,b.jsx)(x.Z,{position:"start",children:(0,b.jsx)(u.RB5,{})})},sx:{width:{xs:"90%",sm:"60%",md:"50%",lg:"20%"}}}),(0,b.jsxs)(l.Z,{sx:{width:{xs:"90%",sm:"60%",md:"50%",lg:"20%"}},children:[C.length>0&&(0,b.jsxs)(l.Z,{children:[(0,b.jsx)(l.Z,{sx:{width:"100%",padding:"15px",border:"black 1px solid",color:"white",background:"linear-gradient(90deg, rgba(20, 163, 214, 0.91) 15%, rgba(0,0,0,1) 85%)"},children:(0,b.jsx)(p.Z,{children:"Users"})}),(0,b.jsx)(l.Z,{sx:{textAlign:"center"},children:C.map((function(e){return(0,b.jsxs)(m.Z,{fullWidth:!0,variant:"filled",color:"primary",onClick:function(){return U("".concat(g._.BASE_URL,"/").concat(g._.USER,"/").concat(e._id))},sx:{border:"solid black 1px",borderTop:"none",padding:"15px",display:"flex",justifyContent:"start",alignItems:"center"},children:[(0,b.jsx)(Z.Z,{profile:e,size:"45",noMargin:!0,margin:"1"}),e.username]},e._id)}))})]}),y.length>0&&(0,b.jsxs)(l.Z,{children:[(0,b.jsx)(l.Z,{sx:{width:"100%",padding:"15px",border:"solid black 1px",borderTop:"none",color:"white",background:"linear-gradient(90deg, rgba(20, 163, 214, 0.91) 15%, rgba(0,0,0,1) 85%)"},children:(0,b.jsx)(p.Z,{children:'Posts starting with tag "'.concat(D,'"')})}),(0,b.jsx)(l.Z,{sx:{textAlign:"center"},children:y.map((function(e){return(0,b.jsxs)(b.Fragment,{children:[E&&(0,b.jsx)(j.Z,{onClose:L,post:e,postUser:e.user,profilePicture:e.user.profilePicture}),(0,b.jsx)(m.Z,{onClick:L,fullWidth:!0,variant:"filled",color:"primary",sx:{border:"solid black 1px",borderTop:"none",padding:"15px",display:"flex",justifyContent:"start",alignItems:"center"},children:(0,b.jsx)(p.Z,{children:e.body},e._id)})]})}))})]})]})]})},y=t(1582),w=t(5527),k=t(3400),S=t(9434),C=t(7692),R=t(6355),I=t(1087),_=t(5880),D=function(){var e=(0,S.v9)((function(e){return e.user})),n=(0,r.useState)(2),t=(0,c.Z)(n,2),s=t[0],i=t[1],a=(0,h.s0)(),o=e.friends.slice(0,s);return(0,b.jsxs)(y.Z,{sx:{width:"20%",padding:"3rem",display:{xs:"none",sm:"none",md:"none",lg:"block"}},elevation:3,component:w.Z,children:[(0,b.jsxs)(l.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:"10px"},children:[(0,b.jsx)(Z.Z,{size:85,profile:e}),(0,b.jsx)(p.Z,{variant:"h5",sx:{marginLeft:"1rem",textTransform:"capitalize",display:{sx:"none",lg:"block"}},children:e.username})]}),(0,b.jsx)("hr",{}),(0,b.jsx)(l.Z,{children:(0,b.jsx)(m.Z,{sx:{margin:"3rem 0"},children:(0,b.jsxs)(I.rU,{to:"".concat(g._.BASE_URL,"/").concat(g._.USER,"/").concat(e._id),style:{textDecoration:"none",color:"inherit",display:"flex",alignItems:"center"},children:[(0,b.jsx)(_.Mdg,{size:"35",style:{margin:"0 1rem"}}),(0,b.jsx)(p.Z,{children:"Profile"})]})})}),(0,b.jsx)("hr",{}),(0,b.jsx)(l.Z,{children:(0,b.jsx)(m.Z,{sx:{margin:"3rem 0"},children:(0,b.jsxs)(I.rU,{to:"".concat(g._.BASE_URL,"/").concat(g._.ADDPOST),style:{textDecoration:"none",color:"inherit",display:"flex",alignItems:"center"},children:[(0,b.jsx)(C.poH,{size:"35",style:{margin:"0 1rem"}}),(0,b.jsx)(p.Z,{children:"Add a post"})]})})}),(0,b.jsx)("hr",{}),(0,b.jsxs)(l.Z,{children:[(0,b.jsx)(m.Z,{sx:{margin:"3rem 0"},children:(0,b.jsxs)(I.rU,{to:"".concat(g._.BASE_URL,"/").concat(g._.FRIENDS),style:{textDecoration:"none",color:"inherit",display:"flex",alignItems:"center"},children:[(0,b.jsx)(R.wN,{size:"35",style:{margin:"0 1rem"}}),(0,b.jsx)(p.Z,{children:"Friends"})]})}),(0,b.jsx)("hr",{}),(0,b.jsxs)(l.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",textAlign:"center"},children:[o.map((function(e,n){return(0,b.jsxs)(m.Z,{sx:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},color:"success",onClick:function(){return a("".concat(g._.BASE_URL,"/").concat(g._.USER,"/").concat(e.friendId))},children:[(0,b.jsx)(p.Z,{children:e.friendName}),(0,b.jsx)("hr",{style:{width:"100%"}})]},n)})),s<e.friends.length&&(0,b.jsxs)(k.Z,{onClick:function(){s+2<=e.friends.length?i(s+2):i(e.friends.length)},children:[(0,b.jsx)(C.poH,{}),(0,b.jsx)(p.Z,{children:"Show more friends"})]})]}),e.friends.length<=0&&(0,b.jsx)("hr",{})]})]})},N=t(3853),T=t(678),A=[{path:t(640),link:"http://comp.eng.ankara.edu.tr/",alt:"Ankara University"},{path:t(8632),link:"https://react.dev/",alt:"React JS"},{path:t(8644),link:"https://react-icons.github.io/react-icons",alt:"React Icons"}],E=function(){var e=(0,S.I0)(),n=(0,h.s0)();return(0,b.jsxs)(y.Z,{sx:{width:"22%",padding:"3rem",display:{xs:"none",sm:"none",md:"none",lg:"block"}},elevation:3,component:w.Z,children:[(0,b.jsxs)(l.Z,{children:[(0,b.jsx)(p.Z,{variant:"h4",color:"primary",children:"Sponsered"}),(0,b.jsx)("hr",{style:{margin:"1rem 0"}}),A.map((function(e){return(0,b.jsx)(l.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,b.jsx)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",children:(0,b.jsx)("img",{src:e.path,alt:e.alt,style:{marginBottom:"2rem",objectFit:"cover",cursor:"pointer",borderRadius:"10%",imageRendering:["-webkit-optimize-contrast","crisp-edges","pixelated"]},width:"100%",height:"200px"})})},e.alt)}))]}),(0,b.jsx)("hr",{}),(0,b.jsx)(l.Z,{children:(0,b.jsxs)(m.Z,{onClick:function(){e((0,T.kS)(n))},sx:{display:"flex",alignItems:"center",margin:"1rem 0"},children:[(0,b.jsx)(N.xqh,{size:"35",style:{margin:"0 1rem"}}),(0,b.jsx)(p.Z,{children:"Logout"})]})})]})},F=t(9877),L=t(4428),U=t(493),B=t(4852),z=t(653),P=t(3044),M=t(9900),O=t(9823),W=t(3433),H=t(148),K=t(2852),V=function(e){var n=e.sendMessage,t=e.message,r=e.setMessage,s=q();return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)("form",{className:s.wrapForm,noValidate:!0,autoComplete:"off",children:[(0,b.jsx)(d.Z,{id:"standard-text",label:"Chat here...",value:t,className:s.wrapText,onChange:function(e){return r(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&(e.preventDefault(),r(""),n())}}),(0,b.jsx)(m.Z,{variant:"contained",color:"primary",className:s.button,onClick:function(){r(""),n()},children:(0,b.jsx)(H.Z,{})})]})})},q=(0,K.Z)((function(){return{wrapForm:{display:"flex",justifyContent:"center",width:"95%",margin:"0.5rem auto"},wrapText:{width:"100%"},button:{}}})),J=t(5643),Y=(0,K.Z)((function(){return{messageRow:{display:"flex"},messageRowRight:{display:"flex",justifyContent:"flex-end"},messageBlue:{position:"relative",marginLeft:"20px",marginBottom:"10px",padding:"1rem",backgroundColor:"#A8DDFD",width:"200%",textAlign:"left",font:"400 .9em 'Open Sans', sans-serif",border:"1px solid #97C6E3",borderRadius:"10px","&:after":{content:"''",position:"absolute",width:"0",height:"0",borderTop:"15px solid #A8DDFD",borderLeft:"15px solid transparent",borderRight:"15px solid transparent",top:"0",left:"-15px"},"&:before":{content:"''",position:"absolute",width:"0",height:"0",borderTop:"17px solid #97C6E3",borderLeft:"16px solid transparent",borderRight:"16px solid transparent",top:"-1px",left:"-17px"}},messageOrange:{position:"relative",marginRight:"20px",marginBottom:"10px",padding:"10px",backgroundColor:"#f8e896",width:"60%",textAlign:"left",font:"400 .9em 'Open Sans', sans-serif",border:"1px solid #dfd087",borderRadius:"10px","&:after":{content:"''",position:"absolute",width:"0",height:"0",borderTop:"15px solid #f8e896",borderLeft:"15px solid transparent",borderRight:"15px solid transparent",top:"0",right:"-15px"},"&:before":{content:"''",position:"absolute",width:"0",height:"0",borderTop:"17px solid #dfd087",borderLeft:"16px solid transparent",borderRight:"16px solid transparent",top:"-1px",right:"-17px"}},messageContent:{padding:"5px",margin:0,wordWrap:"break-word"},messageTimeStampRight:{position:"absolute",fontSize:".85em",fontWeight:"300",marginTop:"10px",bottom:"0",right:"5px"},orange:{color:"orange",backgroundColor:J.Z[500],width:"1rem",height:"1rem"},avatarNothing:{color:"transparent",backgroundColor:"transparent",width:"1rem",height:"1rem"},displayName:{marginLeft:"20px"}}}));function G(e){return new Date(Date.parse(e)).toLocaleString(void 0,{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1})}var Q=function(e){var n=e.message?e.message:"no message",t=e.timestamp?G(e.timestamp):"";console.log(G(e.timestamp)+"    LAOSLD   "+e.timestamp);var r=Y();return(0,b.jsx)(b.Fragment,{children:(0,b.jsx)("div",{className:r.messageRow,children:(0,b.jsx)("div",{children:(0,b.jsxs)("div",{className:r.messageBlue,children:[(0,b.jsx)("div",{children:(0,b.jsx)("p",{className:r.messageContent,children:n})}),(0,b.jsx)("div",{className:r.messageTimeStampRight,children:t})]})})})})},X=function(e){var n=Y(),t=e.message?e.message:"no message",r=e.timestamp?G(e.timestamp):"";return(0,b.jsx)("div",{className:n.messageRowRight,children:(0,b.jsxs)("div",{className:n.messageOrange,children:[(0,b.jsx)("p",{className:n.messageContent,children:t}),(0,b.jsx)("div",{className:n.messageTimeStampRight,children:r})]})})},$=t(7939),ee=(0,K.Z)((function(e){return(0,$.Z)({paper:{width:"100%",height:"100%",display:"flex",alignItems:"center",flexDirection:"column",position:"relative",padding:"1rem"},paper2:{padding:"10px",display:"flex",alignItems:"center",flexDirection:"column",position:"relative"},container:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem"},messagesBody:{width:"calc( 100% - 20px )",margin:10,overflowY:"scroll",height:"calc( 100% - 80px )"}})})),ne=function(e){var n=e.selectedFriend,t=e.socket,s=ee(),i=(0,S.v9)((function(e){return e.user})),d=(0,r.useState)(""),x=(0,c.Z)(d,2),m=x[0],u=x[1],h=(0,r.useState)([]),g=(0,c.Z)(h,2),j=g[0],Z=g[1],v=(0,r.useState)(1),y=(0,c.Z)(v,2),k=y[0],C=y[1],R=(0,r.useState)(1),I=(0,c.Z)(R,2),_=I[0],D=I[1],N=(0,r.useRef)(null),T=(0,r.useRef)(null),A=function(){var e;null===(e=T.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};(0,r.useEffect)((function(){var e=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.Z.get("/messages/".concat(i._id,"/").concat(n.friendId),{params:{page:k,limit:10}});case 3:t=e.sent,Z((function(e){return[].concat((0,W.Z)(t.data.messages),(0,W.Z)(e))})),D(t.data.totalPages),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Failed to fetch messages:",e.t0.response.data.error);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();e()}),[i._id,n.friendId,k]);(0,r.useLayoutEffect)((function(){var e=N.current;e.scrollTop=e.scrollHeight}),[j]);var E=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={sender:{username:i.username,userId:i._id},receiver:{username:n.friendName,userId:n.friendId},content:m,timestamp:new Date(Date.now())},e.prev=1,e.next=4,f.Z.post("/messages",r);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error("Failed to send message:",e.t0.response.data.error);case 9:A(),t.emit("chat message",r);case 11:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(){return e.apply(this,arguments)}}();return(0,r.useEffect)((function(){t.on("chat message",(function(e){Z((function(n){return[].concat((0,W.Z)(n),[e])}))}))}),[t]),(0,b.jsx)("div",{className:s.container,children:(0,b.jsxs)(l.Z,{className:s.paper,children:[(0,b.jsx)(p.Z,{children:"Chat with ".concat(n.friendName)}),(0,b.jsx)("div",{id:"style-1",ref:N,onScroll:function(){0===N.current.scrollTop&&k<_&&C((function(e){return e+1}))},className:s.messagesBody,children:(0,b.jsxs)(w.Z,{children:[j.map((function(e,n){return e.sender.userId===i._id?(0,b.jsx)(X,{message:e.content,timestamp:e.timestamp},e.message+"-"+n):(0,b.jsx)(Q,{message:e.content,timestamp:e.timestamp},e.message+"-"+n)})),(0,b.jsx)("div",{ref:T})," "]})}),(0,b.jsx)(V,{sendMessage:E,message:m,setMessage:u})]})})},te=function(e){var n=e.setShowChatWindow,t=e.socket,s=(0,S.v9)((function(e){return e.user})),i=(0,r.useState)(null),a=(0,c.Z)(i,2),o=a[0],d=a[1];return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(l.Z,{sx:{position:"fixed",bottom:{xs:"0",lg:"1rem"},right:{xs:"0",lg:"1rem"},zIndex:9999,background:"#fff",width:{xs:"100%",lg:"800px"},height:{xs:"70%",lg:"600px"},borderRadius:"8px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)",padding:"6px"},children:[(0,b.jsx)(k.Z,{sx:{position:"absolute",top:"0.5rem",right:"0.5rem"},onClick:function(){d(null),n(!1)},children:(0,b.jsx)(O.Z,{})}),(0,b.jsxs)(l.Z,{sx:{display:"flex",height:"calc(100% - 48px)"},children:[(0,b.jsxs)(l.Z,{sx:{width:"40%",borderRight:"1px solid #ccc",padding:"0 1rem",overflow:"auto",display:o?{xs:"none",sm:"block"}:"block"},children:[(0,b.jsx)(p.Z,{variant:"h6",children:"Friends"}),(0,b.jsx)(U.Z,{children:s.friends.map((function(e){return(0,b.jsxs)(B.ZP,{button:!0,onClick:function(){return function(e){var n=[s._id,e.friendId].sort().join("_");t.emit("join_room",n),d(e)}(e)},sx:{backgroundColor:(null===o||void 0===o?void 0:o.friendId)===e.friendId?"#f0f0f0":"inherit"},children:[(0,b.jsx)(z.Z,{children:(0,b.jsx)(P.Z,{alt:e.friendName,src:e.friendProfilePicture})}),(0,b.jsx)(M.Z,{primary:e.friendName})]},e.friendName)}))})]}),(0,b.jsx)(l.Z,{sx:{flex:1,display:"flex",flexDirection:"column",margin:"0 1rem"},children:o?(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(ne,{selectedFriend:o,socket:t})}):(0,b.jsx)(p.Z,{variant:"body1",sx:{textAlign:"center",marginTop:"40%"},children:"Select a friend to start chatting"})})]})]})})},re=t(8326),se=L.io.connect("https://social-media-app-server-o938.onrender.com"),ie=function(){var e=(0,r.useState)(!1),n=(0,c.Z)(e,2),t=n[0],s=n[1];return(0,b.jsx)(b.Fragment,{children:t?(0,b.jsx)(te,{setShowChatWindow:s,socket:se}):(0,b.jsx)(F.Z,{color:"primary",size:"large",onClick:function(){s(!t)},sx:{position:"fixed",bottom:"2rem",right:"2rem",zIndex:9999},children:(0,b.jsx)(re.Z,{})})})},ae=t(2284),oe=function(){return(0,b.jsxs)(ae.Z,{children:[(0,b.jsx)(ie,{}),(0,b.jsx)(s.Z,{}),(0,b.jsx)(v,{}),(0,b.jsx)("hr",{style:{margin:"2rem 0"}}),(0,b.jsxs)(l.Z,{sx:{position:"relative",display:"flex",justifyContent:"space-around",overflow:"hidden"},children:[(0,b.jsx)(D,{}),(0,b.jsx)(i.Z,{}),(0,b.jsx)(E,{})]})]})}},8632:function(e,n,t){e.exports=t.p+"static/media/react2.8aa659a4278a7132e6f4.webp"},640:function(e,n,t){e.exports=t.p+"static/media/AnkaraUniv.3b6f069243dfc3faa3f0.png"},8644:function(e,n,t){e.exports=t.p+"static/media/reacticons.78c673e7864b1fb643c5.png"}}]);
//# sourceMappingURL=506.f80752e8.chunk.js.map