"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[698],{5698:function(e,r,n){n.r(r),n.d(r,{default:function(){return K}});var t=n(9439),s=n(2791),i=n(1241),a=n(2284),l=n(2824),o=n(4318),c=n(4165),d=n(5861),u=n(4554),x=n(5527),m=n(6151),f=n(3400),h=n(890),p=n(3538),j=n(8856),Z=n(9126),y=n(6355),v=n(3853),g=n(184),b=function(e){var r=e.profile;return(0,g.jsxs)(u.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,g.jsxs)(u.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,g.jsx)(j.Z,{size:"25"}),(0,g.jsx)(h.Z,{sx:{ml:"5px"},children:r.email})]}),(0,g.jsx)("hr",{style:{border:"none",borderBottom:"1px solid #ccc",margin:"1rem 0"}}),(0,g.jsxs)(u.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,g.jsx)(v.fzv,{size:"25"}),(0,g.jsx)(h.Z,{sx:{ml:"5px"},children:r.username})]}),(0,g.jsx)("hr",{style:{border:"none",borderBottom:"1px solid #ccc",margin:"1rem 0"}}),(0,g.jsxs)(u.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,g.jsx)(Z.t6A,{size:"25"}),(0,g.jsxs)(h.Z,{sx:{ml:"5px"},children:["Posts ",r.posts.length]})]}),(0,g.jsx)("hr",{style:{border:"none",borderBottom:"1px solid #ccc",margin:"1rem 0"}}),(0,g.jsxs)(u.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,g.jsx)(y.wN,{size:"25"}),(0,g.jsxs)(h.Z,{sx:{ml:"5px"},children:["Friends ",r.friends.length]})]}),(0,g.jsx)("hr",{style:{border:"none",borderBottom:"1px solid #ccc",margin:"1rem 0"}})]})},w=n(7892),I=n.n(w),B=n(1134),_=n(2543),D=n(4695),S=n(7689),k=n(8007),C=I()().startOf("day"),O=k.Ry().shape({username:k.Z_("Username must be a string").matches(/^[a-zA-Z0-9_-]{3,10}$/,"Username must be 3-10 characters long and can only contain alphanumeric characters, underscores and hyphens").required("This field can't be empty"),email:k.Z_("Email must be a string").email("Must be a valid email address").required("This field can't be empty"),dateOfBirth:k.nK().nullable(!0).test("valid-date","Date of birth must be a valid date",(function(e){return null===e||I()(e).isValid()})).test("max-date","Date of birth cannot be after today's date",(function(e){return null===e||I()(e).isBefore(C)||I()(e).isSame(C)}))}),M=n(9434),z=n(678),E=n(1413),F=n(5970),U=n(1256),A=function(e){var r=e.control,n=e.errors;return(0,g.jsx)(B.Qr,{control:r,name:"dateOfBirth",render:function(e){var r=e.field,t=e.fieldState;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(U.M,(0,E.Z)((0,E.Z)({},r),{},{inputFormat:"yyyy-MM-dd",label:"Date of Birth",sx:{width:"100%"},error:!!t.error})),(0,g.jsx)(F.B,{errors:n,name:"dateOfBirth",render:function(e){var r=e.message;return(0,g.jsx)(h.Z,{sx:{color:"red"},children:r})}})]})}})},Y=function(e){var r=e.setIsEdit,n=(0,S.s0)(),i=(0,M.I0)(),a=(0,M.v9)((function(e){return e.user})),l=(0,M.v9)((function(e){return e.loading})),x=(0,s.useState)(null),f=(0,t.Z)(x,2),j=f[0],Z=f[1],y=(0,s.useState)(null),v=(0,t.Z)(y,2),b=v[0],w=v[1],k=(0,B.cI)({defaultValues:{username:a?a.username:"",email:a?a.email:"",dateOfBirth:a?I()(a.dateOfBirth):null},resolver:(0,D.X)(O)}),C=k.handleSubmit,E=k.control,F=k.formState.errors,U=function(){var e=(0,d.Z)((0,c.Z)().mark((function e(t,s){var l,o,d,u;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.preventDefault(),l=s.target.username.value,o=s.target.email.value,d=new Date(t.dateOfBirth),u=I()(d).format("YYYY MM DD");try{i((0,z.Nq)(a._id,b,o,l,u,n)),r(!1)}catch(c){Z(c.response)}case 6:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}();return a?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(u.Z,{sx:{my:8,mx:4,display:"flex",flexDirection:"column",alignItems:"center",padding:"2rem"},children:[(0,g.jsx)(h.Z,{variant:"h2",children:"Profile"}),(0,g.jsx)(p.Z,{image:b,setImage:w,profile:a}),(0,g.jsxs)(u.Z,{component:"form",noValidate:!0,onSubmit:C(U),sx:{mt:1},children:[(0,g.jsx)(_.Z,{control:E,name:"username",label:"Username",autoFocus:!0}),(0,g.jsx)(_.Z,{control:E,name:"email",label:"Email",autoFocus:!0}),j&&(0,g.jsx)(h.Z,{sx:{textAlign:"center",color:"red"},position:"center",variant:"h5",children:j}),(0,g.jsx)(A,{control:E,errors:F}),(0,g.jsx)(m.Z,{type:"submit",fullWidth:!0,variant:"contained",color:"secondary",sx:{mt:3,mb:2},disabled:l,children:"Update"})]})]}),(0,g.jsx)(o.Z,{})]}):(0,g.jsx)("div",{children:"Loading..."})},q=n(9272),P=n(8820),R=n(8617),T=function(e){var r=e.profile,n=(0,s.useState)(!1),i=(0,t.Z)(n,2),a=i[0],l=i[1],o=(0,M.I0)(),j=(0,M.v9)((function(e){return e.user})),Z=(0,s.useState)(""),y=(0,t.Z)(Z,2),v=y[0],w=y[1];if(!j||!r)return(0,g.jsx)(q.a,{});if(a)return(0,g.jsx)(Y,{setIsEdit:l});var I=function(){var e=(0,d.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{o((0,z.SK)(r._id))}catch(n){w(n.response.data.error)}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=(0,d.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{o((0,z.tJ)(r._id))}catch(n){w(n.response.data.error)}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,g.jsxs)(u.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",margin:"5rem 0"},children:[(0,g.jsxs)(u.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"50%"},children:[(0,g.jsxs)(x.Z,{elevation:3,sx:{padding:"2rem 2rem",display:"flex",flexDirection:{xs:"column",lg:"row"}},children:[(0,g.jsx)(p.Z,{profile:r}),(0,g.jsx)("div",{style:{borderRight:"1px solid #ccc",margin:"0 1rem"}}),(0,g.jsx)(b,{profile:r})]}),r._id===j._id?(0,g.jsx)(m.Z,{variant:"contained",color:"success",sx:{width:{xs:"90vw",lg:"30vw"}},onClick:function(){l(!0)},children:"Edit profile"}):j.friends.some((function(e){return e.friendId===r._id}))?(0,g.jsx)(f.Z,{onClick:B,children:(0,g.jsx)(R.XTR,{style:{color:"red"}})}):(0,g.jsx)(f.Z,{onClick:I,children:(0,g.jsx)(P.vM4,{style:{color:"green"}})})]}),v&&""!==v&&(0,g.jsx)(h.Z,{sx:{textAlign:"center",color:"red"},position:"center",variant:"h5",children:v})]})},V=n(6927),K=function(){var e=(0,S.s0)(),r=(0,S.UO)().id,n=(0,s.useState)(null),c=(0,t.Z)(n,2),d=c[0],x=c[1];return(0,s.useEffect)((function(){!d&&r&&(0,V.B)(e,{id:r,setProfile:x})}),[r,d,e]),d?(0,g.jsxs)(a.Z,{children:[(0,g.jsx)(i.Z,{}),(0,g.jsxs)(u.Z,{children:[(0,g.jsx)(T,{profile:d}),(0,g.jsx)("hr",{}),(0,g.jsx)(u.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",margin:"2rem 0"},children:(0,g.jsx)(l.Z,{userId:d._id})})]}),(0,g.jsx)(o.Z,{})]}):(0,g.jsx)(q.a,{})}}}]);
//# sourceMappingURL=698.554ea7fb.chunk.js.map