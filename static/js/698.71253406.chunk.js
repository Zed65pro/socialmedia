"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[698],{5698:function(e,r,n){n.r(r),n.d(r,{default:function(){return K}});var t=n(2791),s=n(1241),i=n(2284),a=n(2824),l=n(4318),o=n(4165),c=n(5861),d=n(9439),u=n(4554),x=n(5527),m=n(6151),f=n(3400),h=n(890),p=n(3538),j=n(8856),Z=n(9126),y=n(6355),v=n(3853),g=n(184),b=function(e){var r=e.profile;return(0,g.jsxs)(u.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,g.jsxs)(u.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,g.jsx)(j.Z,{size:"25"}),(0,g.jsx)(h.Z,{sx:{ml:"5px"},children:r.email})]}),(0,g.jsx)("hr",{style:{border:"none",borderBottom:"1px solid #ccc",margin:"1rem 0"}}),(0,g.jsxs)(u.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,g.jsx)(v.fzv,{size:"25"}),(0,g.jsx)(h.Z,{sx:{ml:"5px"},children:r.username})]}),(0,g.jsx)("hr",{style:{border:"none",borderBottom:"1px solid #ccc",margin:"1rem 0"}}),(0,g.jsxs)(u.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,g.jsx)(Z.t6A,{size:"25"}),(0,g.jsxs)(h.Z,{sx:{ml:"5px"},children:["Posts ",r.posts.length]})]}),(0,g.jsx)("hr",{style:{border:"none",borderBottom:"1px solid #ccc",margin:"1rem 0"}}),(0,g.jsxs)(u.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,g.jsx)(y.wN,{size:"25"}),(0,g.jsxs)(h.Z,{sx:{ml:"5px"},children:["Friends ",r.friends.length]})]}),(0,g.jsx)("hr",{style:{border:"none",borderBottom:"1px solid #ccc",margin:"1rem 0"}})]})},I=n(1413),w=n(7892),B=n.n(w),_=n(1134),D=n(2543),S=n(4695),k=n(7689),C=n(8007),O=B()().startOf("day"),M=C.Ry().shape({username:C.Z_("Username must be a string").matches(/^[a-zA-Z0-9_-]{3,10}$/,"Username must be 3-10 characters long and can only contain alphanumeric characters, underscores and hyphens").required("This field can't be empty"),email:C.Z_("Email must be a string").email("Must be a valid email address").required("This field can't be empty"),dateOfBirth:C.nK().nullable(!0).test("valid-date","Date of birth must be a valid date",(function(e){return null===e||B()(e).isValid()})).test("max-date","Date of birth cannot be after today's date",(function(e){return null===e||B()(e).isBefore(O)||B()(e).isSame(O)}))}),P=n(9434),z=n(5970),E=n(1256),F=function(e){var r=e.control,n=e.errors;return(0,g.jsx)(_.Qr,{control:r,name:"dateOfBirth",render:function(e){var r=e.field,t=e.fieldState;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(E.M,(0,I.Z)((0,I.Z)({},r),{},{inputFormat:"yyyy-MM-dd",label:"Date of Birth",sx:{width:"100%"},error:!!t.error})),(0,g.jsx)(z.B,{errors:n,name:"dateOfBirth",render:function(e){var r=e.message;return(0,g.jsx)(h.Z,{sx:{color:"red"},children:r})}})]})}})},U=n(6551),A=function(e){var r=e.setIsEdit,n=e.setProfile,s=(0,k.s0)(),i=(0,P.I0)(),a=(0,P.v9)((function(e){return e.user})),x=(0,P.v9)((function(e){return e.loading})),f=(0,t.useState)(null),j=(0,d.Z)(f,2),Z=j[0],y=j[1],v=(0,t.useState)(null),b=(0,d.Z)(v,2),w=b[0],C=b[1],O=(0,_.cI)({defaultValues:{username:a?a.username:"",email:a?a.email:"",dateOfBirth:a?B()(a.dateOfBirth):null},resolver:(0,S.X)(M)}),z=O.handleSubmit,E=O.control,A=O.formState.errors,Y=function(){var e=(0,c.Z)((0,o.Z)().mark((function e(t,l){var c,d,u,x;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l.preventDefault(),c=l.target.username.value,d=l.target.email.value,u=new Date(t.dateOfBirth),x=B()(u).format("YYYY MM DD");try{i((0,U.Nq)(a._id,w,d,c,x,s)),n((function(e){return(0,I.Z)((0,I.Z)({},e),{},{username:c,dateOfBirth:x,email:d,profilePicture:w||a.profilePicture})})),r(!1)}catch(o){y(o.response)}case 6:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}();return a?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(u.Z,{sx:{my:8,mx:4,display:"flex",flexDirection:"column",alignItems:"center",padding:"2rem"},children:[(0,g.jsx)(h.Z,{variant:"h2",children:"Profile"}),(0,g.jsx)(p.Z,{image:w,setImage:C,profile:a}),(0,g.jsxs)(u.Z,{component:"form",noValidate:!0,onSubmit:z(Y),sx:{mt:1},children:[(0,g.jsx)(D.Z,{control:E,name:"username",label:"Username",autoFocus:!0}),(0,g.jsx)(D.Z,{control:E,name:"email",label:"Email",autoFocus:!0}),Z&&(0,g.jsx)(h.Z,{sx:{textAlign:"center",color:"red"},position:"center",variant:"h5",children:Z}),(0,g.jsx)(F,{control:E,errors:A}),(0,g.jsx)(m.Z,{type:"submit",fullWidth:!0,variant:"contained",color:"secondary",sx:{mt:3,mb:2},disabled:x,children:"Update"})]})]}),(0,g.jsx)(l.Z,{})]}):(0,g.jsx)("div",{children:"Loading..."})},Y=n(9272),q=n(8820),R=n(8617),T=n(6927),V=function(e){var r=e.id,n=(0,P.I0)(),s=(0,k.s0)(),i=(0,P.v9)((function(e){return e.user})),a=(0,t.useState)(""),l=(0,d.Z)(a,2),j=l[0],Z=l[1],y=(0,t.useState)(!1),v=(0,d.Z)(y,2),I=v[0],w=v[1],B=(0,t.useState)(i._id===r?i:null),_=(0,d.Z)(B,2),D=_[0],S=_[1];(0,t.useEffect)((function(){!D&&r&&(0,T.B)(s,{id:r,setProfile:S})}),[r,D,s]);var C=function(){var e=(0,c.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{n((0,U.SK)(D._id))}catch(r){Z(r.response.data.error)}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=(0,c.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{n((0,U.tJ)(D._id))}catch(r){Z(r.response.data.error)}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return D?I?(0,g.jsx)(A,{setIsEdit:w,setProfile:S}):(0,g.jsxs)(u.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",margin:"5rem 0"},children:[(0,g.jsx)(u.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%"},children:(0,g.jsxs)(x.Z,{elevation:3,sx:{padding:"2rem 2rem",display:"flex",flexDirection:{xs:"column",lg:"column"}},children:[(0,g.jsx)(p.Z,{profile:D}),(0,g.jsx)("div",{style:{borderRight:"1px solid #ccc",margin:"0 1rem"}}),(0,g.jsx)(b,{profile:D}),D._id===i._id?(0,g.jsx)(m.Z,{variant:"contained",color:"success",sx:{width:{xs:"90vw",lg:"30vw"}},onClick:function(){w(!0)},children:"Edit profile"}):i.friends.some((function(e){return e.friendId===D._id}))?(0,g.jsx)(f.Z,{onClick:O,children:(0,g.jsx)(R.XTR,{style:{color:"red"}})}):(0,g.jsx)(f.Z,{onClick:C,children:(0,g.jsx)(q.vM4,{style:{color:"green"}})})]})}),j&&""!==j&&(0,g.jsx)(h.Z,{sx:{textAlign:"center",color:"red"},position:"center",variant:"h5",children:j})]}):(0,g.jsx)(Y.a,{})},K=function(){var e=(0,k.UO)().id;return(0,g.jsxs)(i.Z,{children:[(0,g.jsx)(s.Z,{}),(0,g.jsxs)(u.Z,{children:[(0,g.jsx)(V,{id:e}),(0,g.jsx)("hr",{}),(0,g.jsx)(u.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",margin:"2rem 0"},children:(0,g.jsx)(a.Z,{userId:e})})]}),(0,g.jsx)(l.Z,{})]})}}}]);
//# sourceMappingURL=698.71253406.chunk.js.map